比赛心得
## abc384

1. **一些统计上的技巧：分组分别统计，思想是：这道题要求出 $n^2$ 个数字的和，但是一个一个统计肯定TLE。因此把这些数字分组，一次算出一组的和，最后再相加。** 

对于这道题的 F，我们可以发现： $f(x)=x/2^k$，其中 $k$ 是满足 $x\%2^k=0$ 最大的 $k$ 我们记 $g(x)=$ 最大的 $k$ 使得 $x\%2^k=0$。

然后对于题目的求和，可以转化成 $\sum_{i=1}^N\sum_{j=i}^{N}f(A_i+A_j)=\sum_{i=1}^N\sum_{j=i}^{N}(A_i+A_j)/2^k$，但直接算肯定不好算，我们肯定是把 $2^k$ 提出来，然后把 $A_i+A_j$ 分成 $2^k$ 份，再分别算。也就是 $1/2^k\times\sum_{i=1}^N\sum_{j=i}^{N}(A_i+A_j)\times (g(A_i+A_j)=k)$，但我们算 $g(A_i+A_j)=k$ 很困难，但我们算 $g(A_i+A_j)>=k$ 却很容易（因为只要算 $g(A_i+A_j)\% 2^k=0$ 即可），那么我们用 $d_i$ 表述满足上述条件的个数，然后通过容斥原理算出 $d(k)-d(k-1)$。

**一般对于这种题，双层循环内的值最好是 []，就是满足就是1，不满足就是0，这样就完成了分组**

其中 $(A_i+A_j)\% 2^k=0$ 即：$A_i=-A_j(mod )$，因此可以把 Aj 按照 2^k 的结果分组，记录每组中有几个 Aj 以及他们的和是多少。